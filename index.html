<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SASTIK GBQ+ Verse Filter</title>
  <style>
    body { 
      font-family: Arial, sans-serif; 
      margin: 20px; 
      background-color: #f9f9f9; 
      position: relative; 
      min-height: 100vh; 
      display: flex;
      flex-direction: column;
    }
    .header-container { 
      display: flex; 
      justify-content: center; 
      align-items: center; 
      margin-bottom: 20px; 
    }
    .logo { 
      width: 80px; 
      height: auto; 
      margin-right: 10px; 
    }
    h2 { 
      color: #0066cc; /* Blue for hyperlink */
      text-align: center; 
      margin: 0; 
      font-size: 1.8em; /* Slightly smaller than 80px logo */
      font-weight: bold; 
      white-space: nowrap; 
      text-decoration: none; 
    }
    h2 a { 
      color: #0066cc; 
      text-decoration: none; 
    }
    h2 a:hover { 
      text-decoration: underline; 
    }
    .header-info { 
      position: absolute; 
      top: 20px; 
      right: 20px; 
      font-size: 0.9em; 
      color: #666; 
    }
    .mission-statement { 
      text-align: center; 
      margin: 0 auto 10px; /* Reduced margin for new line */
      max-width: 80%; 
      font-size: 1.1em; 
      line-height: 1.5; 
      font-weight: bold; 
    }
    .mission-subtext { 
      text-align: center; 
      margin: 0 auto 20px; 
      max-width: 80%; 
      font-size: 1.1em; 
      line-height: 1.5; 
      font-weight: normal; 
    }
    .controls { 
      margin-bottom: 20px; 
      text-align: center; 
      display: flex; 
      justify-content: center; 
      align-items: center; 
      gap: 10px; 
    }
    .content-count { 
      font-size: 1em; 
      color: #333; 
    }
    select, input { padding: 5px; margin-right: 10px; }
    table { 
      border-collapse: collapse; 
      width: 80%; 
      margin: 0 auto 20px; 
      background-color: #fff; 
      box-shadow: 0 0 10px rgba(0,0,0,0.1); 
      position: relative; 
      z-index: 1; 
    }
    th, td { border: 1px solid #ddd; padding: 10px; text-align: center; }
    td a { color: #0066cc; text-decoration: none; }
    td a:hover { text-decoration: underline; }
    td.category-universal { background-color: #00FF00; }
    td.category-general { background-color: #00FFFF; }
    td.category-controversial { background-color: #FFFF00; }
    td.category-divisive { background-color: #FF0000; }
    td.category-violent { background-color: #000000; color: #FFFFFF; }
    th.gita-header { background-color: orange; color: black; }
    th.bible-header { background-color: blue; color: white; }
    th.quran-header { background-color: green; color: white; }
    th.hadith-header, th.miscellaneous-header { background-color: #4CAF50; color: white; }
    .footer { 
      position: relative; 
      margin-top: auto; 
      display: flex; 
      flex-direction: column; 
      align-items: center; 
      max-width: 80%; 
      margin: 20px auto 0; 
      padding: 10px 0; 
      pointer-events: auto; 
    }
    .footer a { 
      text-decoration: none; 
      cursor: pointer; 
      pointer-events: auto; 
    }
    .footer img { 
      vertical-align: middle; 
      pointer-events: auto; 
    }
    .logos { 
      display: flex; 
      align-items: center; 
      margin-bottom: 5px; 
    }
    .logos img { 
      width: 60px; 
      height: auto; 
      margin-right: 5px; 
    }
    .logos img:last-child { 
      margin-right: 0; 
    }
    .text-group { 
      display: flex; 
      flex-direction: column; 
      align-items: center; 
      text-align: center; 
    }
    .support-text { 
      font-weight: bold; 
      font-size: 1em; 
      margin-bottom: 10px; 
    }
    .support-text span { 
      display: block; 
    }
    .follow-text, .contact-text { 
      font-size: 1.1em; 
      margin: 2px 0; 
    }
    .name-text { 
      font-size: 2em; 
      margin: 5px 0; 
    }
    .contact-text { 
      white-space: nowrap; 
      font-size: 1.1em; 
      max-width: 100%; 
      overflow: hidden; 
      text-overflow: ellipsis; 
      pointer-events: auto; 
    }
    .contact-text img { 
      width: 30px; 
      height: auto; 
    }
    .qr-code { 
      margin: 10px 0; 
    }
    .qr-code img { 
      width: 150px; 
      height: auto; 
    }
    @media (max-width: 600px) {
      table { width: 100%; }
      .mission-statement { font-size: 0.9em; max-width: 90%; }
      .mission-subtext { font-size: 0.9em; max-width: 90%; }
      h2 { font-size: 1.4em; }
      select, input { width: 100%; margin-bottom: 10px; }
      .controls { flex-direction: column; align-items: center; }
      .content-count { margin-top: 10px; }
      .header-container { flex-direction: column; text-align: center; }
      .logo { margin-right: 0; margin-bottom: 10px; width: 60px; }
      .footer { max-width: 90%; }
      .logos img { width: 45px; margin-right: 3px; }
      .logos img:last-child { margin-right: 0; }
      .follow-text, .contact-text { font-size: 0.9em; }
      .contact-text { max-width: 90%; }
      .contact-text img { width: 20px; }
      .qr-code img { width: 120px; }
      .support-text { font-size: 0.9em; }
    }
  </style>
</head>
<body>
  <div class="header-info">
    <span class="last-updated" id="lastUpdated">Last updated: loading...</span>
  </div>
  <div class="header-container">
    <img src="sastik_logo.png" alt="SASTIK Logo" class="logo" onerror="this.style.display='none';console.log('SASTIK logo failed to load');">
    <h2><a href="https://www.facebook.com/sastikofficial/" target="_blank">SASTIK GBQ+</a></h2>
  </div>
  <div class="mission-statement">
    <b>‡¶∏‡ßÅ‡¶∏‡ßç‡¶• ‡¶Ü‡¶∏‡ßç‡¶§‡¶ø‡¶ï‡¶§‡¶æ ‡¶™‡ßç‡¶∞‡¶ö‡¶æ‡¶∞‡ßá‡¶∞ ‡¶â‡¶¶‡ßç‡¶¶‡ßá‡¶∂‡ßç‡¶Ø‡ßá, ‡¶π‡¶ø‡¶Ç‡¶∏‡¶æ ‡¶ì ‡¶¨‡¶ø‡¶¶‡ßç‡¶¨‡ßá‡¶∑‡ßá‡¶∞ ‡¶¨‡¶ø‡¶∞‡ßÅ‡¶¶‡ßç‡¶ß‡ßá, ‡¶∏‡¶Æ‡ßç‡¶™‡ßç‡¶∞‡ßÄ‡¶§‡¶ø ‡¶ì ‡¶Æ‡¶æ‡¶®‡¶¨‡¶§‡¶æ‡¶∞ ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‚úÖ</b><br>
    <b>To Propagate Sane Theism, Against Hatred and Violence üö´ In Favor of Harmony and Humanity ‚úÖ</b>
  </div>
  <div class="mission-subtext">
    A unified platform offering categorized theological verses based on modern-day relevance‚Äîempowering you to apply or disregard teachings wisely and avoid the misguidance of charlatans.
  </div>
  <div class="controls">
    <label for="sheetSelector">Select Sheet:</label>
    <select id="sheetSelector" onchange="loadSheetData()">
      <option value="">Select a sheet</option>
      <option value="gita">Gita</option>
      <option value="bible">Bible</option>
      <option value="quran">Quran</option>
      <option value="hadith">Hadith</option>
      <option value="miscellaneous">Miscellaneous</option>
    </select>
    <label for="categoryFilter">Filter by Category:</label>
    <select id="categoryFilter" onchange="filterTable()">
      <option value="">All</option>
      <option value="Universal or Ethical Verse">Universal or Ethical Verse</option>
      <option value="General Intra-community Verse">General Intra-community Verse</option>
      <option value="Controversial Intra-community Verse">Controversial Intra-community Verse</option>
      <option value="Divisive or Hateful Inter-community Verse">Divisive or Hateful Inter-community Verse</option>
      <option value="Violent or Aggressive Inter-community Verse">Violent or Aggressive Inter-community Verse</option>
    </select>
    <label for="subCategoryFilter">Filter by Sub Category:</label>
    <select id="subCategoryFilter" onchange="filterTable()">
      <option value="">All</option>
      <option value="Historical or Narrative verse">Historical or Narrative verse</option>
      <option value="Discriminatory or Prejudiced Verse">Discriminatory or Prejudiced Verse</option>
      <option value="Metaphorical or Symbolic verse">Metaphorical or Symbolic verse</option>
    </select>
    <div class="content-count" id="contentCount">Contents: 0</div>
    <input type="text" id="searchInput" placeholder="Search in table..." onkeyup="searchTable()">
  </div>
  <table id="verseTable">
    <thead id="tableHeaders"></thead>
    <tbody id="verseBody"></tbody>
  </table>
  <div class="footer">
    <div class="text-group">
      <div class="support-text">
        <span>To continue the SASTIK mission for a better, harmonious society,</span>
        <span>you can support us by scanning the <a href="upi://pay?pa=subhendu.srk1993-1@okicici&pn=Subhendu%20Ghosh&aid=uGICAgIDIy-m-Kw" target="_blank">UPI QR code</a> and encouraging our efforts.</span>
      </div>
      <div class="qr-code">
        <a href="upi://pay?pa=subhendu.srk1993-1@okicici&pn=Subhendu%20Ghosh&aid=uGICAgIDIy-m-Kw" target="_blank"><img src="qrcode_logo.jpg" alt="UPI QR Code" onerror="console.log('UPI QR code failed to load')"></a>
      </div>
      <div class="follow-text">For more insights, follow me on üëá</div>
      <div class="logos">
        <a href="https://www.facebook.com/SubhenduGhoshSastik/" target="_blank"><img src="facebook_logo.png" alt="Facebook" onload="console.log('Facebook logo loaded')" onerror="console.log('Facebook logo failed to load')"></a>
        <a href="https://www.youtube.com/@SGSastik" target="_blank"><img src="youtube_logo.png" alt="YouTube" onload="console.log('YouTube logo loaded')" onerror="console.log('YouTube logo failed to load')"></a>
        <a href="https://x.com/subhendug1793" target="_blank"><img src="x_logo.png" alt="X" onload="console.log('X logo loaded')" onerror="console.log('X logo failed to load or fallback to SVG')"></a>
      </div>
      <div class="name-text">Subhendu Ghosh Sastik</div>
      <div class="contact-text">If you want to contribute the verse or connect with us, connect me to <a href="https://t.me/Sg1793" target="_blank"><img src="https://upload.wikimedia.org/wikipedia/commons/8/82/Telegram_logo.svg" alt="Connect"></a> or mail us at <a href="mailto:sastikofficial@gmail.com" target="_blank"><img src="gmail_logo.png" alt="Mail"></a><a href="mailto:sastikofficial@gmail.com" style="color: #0066cc; text-decoration: none;">sastikofficial@gmail.com</a></div>
    </div>
  </div>

  <script>
    let data = [];

    function loadSheetData() {
      const sheetName = document.getElementById("sheetSelector").value;
      if (sheetName) {
        fetch(`${sheetName}.json`)
          .then(response => {
            if (!response.ok) {
              throw new Error(`HTTP error! Status: ${response.status} - Check if ${sheetName}.json exists in the repository`);
            }
            return response.json();
          })
          .then(sheetData => {
            data = sheetData;
            updateHeaders(sheetName);
            updateTable(data);
            updateContentCount(data.length);
            console.log("Loaded data for sheet:", sheetName, "Rows:", data.length, "Sample Verse Category:", data[0] ? data[0]["Verse Category "] : "N/A", "Full Data:", data);
          })
          .catch(error => {
            console.error("Error loading JSON:", error.message);
            document.getElementById("verseBody").innerHTML = `<tr><td colspan="${Object.keys(data[0] || {}).length || 1}" style="text-align: center;">Error loading ${sheetName}.json: ${error.message}</td></tr>`;
            updateContentCount(0);
          });
      } else {
        document.getElementById("verseBody").innerHTML = "";
        document.getElementById("tableHeaders").innerHTML = "";
        updateContentCount(0);
      }
      updateLastUpdated();
    }

    function updateHeaders(sheetName) {
      const thead = document.getElementById("tableHeaders");
      thead.innerHTML = "";
      if (data.length > 0) {
        let tr = document.createElement("tr");
        const headers = Object.keys(data[0]).filter(h => h !== "sheet");
        headers.forEach(header => {
          let th = document.createElement("th");
          th.textContent = header;
          switch (sheetName) {
            case "gita":
              th.classList.add("gita-header");
              break;
            case "bible":
              th.classList.add("bible-header");
              break;
            case "quran":
              th.classList.add("quran-header");
              break;
            case "hadith":
              th.classList.add("hadith-header");
              break;
            case "miscellaneous":
              th.classList.add("miscellaneous-header");
              break;
          }
          tr.appendChild(th);
        });
        thead.appendChild(tr);
      }
    }

    function updateTable(rows) {
      const tbody = document.getElementById("verseBody");
      tbody.innerHTML = "";
      if (rows.length === 0) {
        let tr = document.createElement("tr");
        let td = document.createElement("td");
        td.textContent = "No data available or error loading data";
        td.colSpan = Object.keys(data[0] || {}).length || 1;
        td.style.textAlign = "center";
        tr.appendChild(td);
        tbody.appendChild(tr);
      } else {
        rows.forEach(row => {
          let tr = document.createElement("tr");
          const headers = Object.keys(row).filter(h => h !== "sheet");
          headers.forEach(header => {
            let td = document.createElement("td");
            const content = typeof row[header] === "object" && row[header].url
              ? `<a href="${row[header].url}" target="_blank">${row[header].text}</a>`
              : row[header] || "";
            td.innerHTML = content;
            if (header === "Verse Category " && typeof row[header] === "string") {
              td.className = getCategoryClass(row[header].trim().toLowerCase());
            }
            tr.appendChild(td);
          });
          tbody.appendChild(tr);
        });
      }
      updateContentCount(rows.length);
    }

    function getCategoryClass(category) {
      switch (category.toLowerCase()) {
        case "universal or ethical verse": return "category-universal";
        case "general intra-community verse": return "category-general";
        case "controversial intra-community verse": return "category-controversial";
        case "divisive or hateful inter-community verse": return "category-divisive";
        case "violent or aggressive inter-community verse": return "category-violent";
        default: return "";
      }
    }

    function filterTable() {
      const category = document.getElementById("categoryFilter").value;
      const subCategory = document.getElementById("subCategoryFilter").value;
      const sheetName = document.getElementById("sheetSelector").value;
      if (sheetName && data.length > 0) {
        let filteredRows = data.filter(row => {
          const categoryMatch = !category || (row["Verse Category "] && typeof row["Verse Category "] === "string" && 
                                            row["Verse Category "].trim().toLowerCase() === category.toLowerCase());
          const subCategoryMatch = !subCategory || (row["Sub Category"] && typeof row["Sub Category"] === "string" && 
                                                  row["Sub Category"].trim().toLowerCase() === subCategory.toLowerCase());
          return categoryMatch && subCategoryMatch;
        });
        console.log("Filter category:", category, "Sub category:", subCategory, "Filtered rows:", filteredRows.length, 
                    "Sample Verse Category:", filteredRows[0] ? filteredRows[0]["Verse Category "] : "N/A", 
                    "Sample Sub Category:", filteredRows[0] ? filteredRows[0]["Sub Category"] : "N/A",
                    "All Categories:", data.map(row => row["Verse Category "]),
                    "All Sub Categories:", data.map(row => row["Sub Category"]));
        updateTable(filteredRows);
      }
    }

    function searchTable() {
      const searchTerm = document.getElementById("searchInput").value.toLowerCase().trim();
      if (data.length > 0) {
        let filteredRows = searchTerm === "" ? data : data.filter(row =>
          Object.values(row).some(val =>
            val && typeof val === "string" && val.toLowerCase().includes(searchTerm) ||
            (typeof val === "object" && val.text && val.text.toLowerCase().includes(searchTerm))
          )
        );
        updateTable(filteredRows);
      }
    }

    function updateContentCount(count) {
      document.getElementById("contentCount").textContent = `Contents: ${count}`;
    }

    function updateLastUpdated() {
      try {
        const lastUpdated = new Date(document.lastModified).toLocaleString('en-IN', { timeZone: 'Asia/Kolkata' }).replace(/,\s\d{4}$/, '');
        document.getElementById("lastUpdated").textContent = `Last updated: ${lastUpdated}`;
      } catch (error) {
        console.error("Error updating last modified:", error);
        document.getElementById("lastUpdated").textContent = `Last updated: Unknown`;
      }
    }

    window.onload = updateLastUpdated;
  </script>
</body>
</html>
